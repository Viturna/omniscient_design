<style>
  .status-select {
    margin: 0;
    padding: 0;
    background: none;
    border: none;
    cursor: pointer;
    font-size: 14px;
  }
  form select{
    width: fit-content;
  }
</style>
<section class="top-default-page">
   <%= link_to root_path, class: ("active" if @current_page == "users") do %>
   <svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g clip-path="url(#clip0_3256_104)">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M18 0C27.9345 0 36 8.0655 36 18C36 27.9345 27.9345 36 18 36C8.0655 36 0 27.9345 0 18C0 8.0655 8.0655 0 18 0ZM20.214 22.4325C21.696 21.825 22.8495 20.616 23.388 19.1085L27 9L16.992 12.5805C15.483 13.1205 14.2755 14.277 13.668 15.759L9.0705 27L20.214 22.4325ZM20.031 16.0035C20.8575 16.83 20.8575 18.1725 20.031 18.9975C19.2045 19.824 17.8635 19.824 17.037 18.9975C16.2105 18.1725 16.2105 16.83 17.037 16.0035C17.8635 15.177 19.2045 15.177 20.031 16.0035Z" fill="#FFF"/>
          </g>
          <defs>
            <clipPath id="clip0_3256_104">
              <rect width="36" height="36" fill="white"/>
            </clipPath>
          </defs>
        </svg>
   <% end %>
  <h1>Signalements de bugs</h1>
</section>
<section class="grid-1">
  <h2>À faire</h2>
  <div class="table-wrapper">
    <table>
      <thead>
        <tr>
          <th>Description</th>
          <th>URL</th>
          <th>Signalé par</th>
          <th>Date</th>
          <th>Statut</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @bug_reports_todo.each do |bug_report| %>
          <tr>
            <td><%= bug_report.description %></td>
            <td><%= bug_report.url %></td>
            <td><%= bug_report.user.email %></td>
            <td><%= l(bug_report.created_at, format: :long) %></td>
            <td>
              <%= form_with url: update_status_bug_report_path(bug_report), method: :patch, local: true, class: "status-form" do %>
                <%= select_tag :status, options_for_select(BugReport::STATUSES, bug_report.status), class: 'status-select', onchange: 'this.form.submit()' %>
              <% end %>
            </td>
            <td>
              <%= link_to 'Voir', bug_report_path(bug_report), class: 'btn' %>
              <%= link_to 'Supprimer', bug_report, method: :delete, data: { confirm: 'Êtes-vous sûr?' }, class: 'btn btn-danger' %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
    <button id="load-more-button-todo" class="btn">Voir plus</button>
  </div>
</section>
<section class="grid-1">
  <h2>En cours</h2>
  <div class="table-wrapper">
    <table>
      <thead>
        <tr>
          <th>Description</th>
          <th>URL</th>
          <th>Signalé par</th>
          <th>Date</th>
          <th>Statut</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @bug_reports_in_progress.each do |bug_report| %>
          <tr>
            <td><%= bug_report.description %></td>
            <td><%= bug_report.url %></td>
            <td><%= bug_report.user.email %></td>
            <td><%= l(bug_report.created_at, format: :long) %></td>
            <td>
              <%= form_with url: update_status_bug_report_path(bug_report), method: :patch, local: true, class: "status-form" do %>
                <%= select_tag :status, options_for_select(BugReport::STATUSES, bug_report.status), class: 'status-select', onchange: 'this.form.submit()' %>
              <% end %>
            </td>
            <td>
              <%= link_to 'Voir', bug_report_path(bug_report), class: 'btn' %>
              <%= link_to 'Supprimer', bug_report, method: :delete, data: { confirm: 'Êtes-vous sûr?' }, class: 'btn btn-danger' %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
    <button id="load-more-button-in-progress" class="btn">Voir plus</button>
  </div>
</section>
<section class="grid-1">
  <h2>Corrigé</h2>
  <div class="table-wrapper">
    <table>
      <thead>
        <tr>
          <th>Description</th>
          <th>URL</th>
          <th>Signalé par</th>
          <th>Date</th>
          <th>Statut</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @bug_reports_resolved.each do |bug_report| %>
          <tr>
            <td><%= bug_report.description %></td>
            <td><%= bug_report.url %></td>
            <td><%= bug_report.user.email %></td>
            <td><%= l(bug_report.created_at, format: :long) %></td>
            <td>
              <%= form_with url: update_status_bug_report_path(bug_report), method: :patch, local: true, class: "status-form" do %>
                <%= select_tag :status, options_for_select(BugReport::STATUSES, bug_report.status), class: 'status-select', onchange: 'this.form.submit()' %>
              <% end %>
            </td>
            <td>
              <%= link_to 'Voir', bug_report_path(bug_report), class: 'btn' %>
              <%= link_to 'Supprimer', bug_report, method: :delete, data: { confirm: 'Êtes-vous sûr?' }, class: 'btn btn-danger' %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
    <button id="load-more-button-resolved" class="btn">Voir plus</button>
  </div>
</section>
<section class="grid-1">
  <h2>Tous les reports</h2>
  <div class="table-wrapper">
    <table>
      <thead>
        <tr>
          <th>Description</th>
          <th>URL</th>
          <th>Signalé par</th>
          <th>Date</th>
          <th>Statut</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @bug_reports_all.each do |bug_report| %>
          <tr>
            <td><%= bug_report.description %></td>
            <td><%= bug_report.url %></td>
            <td><%= bug_report.user.email %></td>
            <td><%= l(bug_report.created_at, format: :long) %></td>
            <td>
              <%= form_with url: update_status_bug_report_path(bug_report), method: :patch, local: true, class: "status-form" do %>
                <%= select_tag :status, options_for_select(BugReport::STATUSES, bug_report.status), class: 'status-select', onchange: 'this.form.submit()' %>
              <% end %>
            </td>
            <td>
              <%= link_to 'Voir', bug_report_path(bug_report), class: 'btn' %>
              <%= link_to 'Supprimer', bug_report, method: :delete, data: { confirm: 'Êtes-vous sûr?' }, class: 'btn btn-danger' %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
    <button id="load-more-button-all" class="btn">Voir plus</button>
  </div>
</section>
